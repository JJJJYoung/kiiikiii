<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¡ ì›€ì§ì„ ê°ì§€ ì•Œë¦¬ë¯¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0; /* ë°°ê²½ìƒ‰ ì—°í•œ íšŒìƒ‰ */
            margin: 0;
            padding: 20px; /* ì—¬ë°± ì¶”ê°€ */
            box-sizing: border-box; /* íŒ¨ë”© í¬í•¨ í¬ê¸° ê³„ì‚° */
        }
        .status-container {
            text-align: center;
            padding: 40px;
            border-radius: 15px; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            background-color: #fff; /* í•˜ì–€ ë°°ê²½ */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1); /* ê·¸ë¦¼ì íš¨ê³¼ */
            width: 90%; /* ì»¨í…Œì´ë„ˆ ë„ˆë¹„ */
            max-width: 500px; /* ìµœëŒ€ ë„ˆë¹„ ì œí•œ */
        }
        h1 {
            color: #333; /* ì–´ë‘ìš´ ê¸€ììƒ‰ */
            margin-bottom: 20px;
            font-size: 1.8em; /* ì œëª© í¬ê¸° */
        }
        #motionStatus {
            font-size: 3em; /* ìƒíƒœ ê¸€ì í¬ê¸° */
            font-weight: bold;
            color: #555; /* ê¸°ë³¸ ê¸€ììƒ‰ */
            transition: color 0.5s ease; /* ìƒ‰ìƒ ë³€í™” ë¶€ë“œëŸ½ê²Œ */
        }
        .status-detected {
            color: #e74c3c; /* ì›€ì§ì„ ê°ì§€ ì‹œ ë¶‰ì€ìƒ‰ (ê°•ë ¬í•˜ê²Œ!) */
        }
        .status-no-motion {
            color: #2ecc71; /* ì›€ì§ì„ ì—†ì„ ì‹œ ì´ˆë¡ìƒ‰ (í‰í™”ë¡­ê²Œ!) */
        }
        .status-loading {
             color: #f39c12; /* ë¡œë”© ì¤‘ ì£¼í™©ìƒ‰ (ê¸°ë‹¤ë¦¬ëŠ” ì¤‘!) */
        }
        .footer {
            margin-top: 30px;
            font-size: 0.9em;
            color: #888;
        }
    </style>
</head>
<body>

    <div class="status-container">
        <h1>ğŸ  í˜„ì¬ ì›€ì§ì„ ê°ì§€ ìƒíƒœ</h1>
        <p id="motionStatus" class="status-loading">ìƒíƒœ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        <div class="footer">
            <p>ESP32 + HC-SR501 í”„ë¡œì íŠ¸</p>
        </div>
    </div>

    <script>
        // ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡
        // !!! í•µí•µí•µ ì¤‘ìš” !!!
        // ì—¬ê¸° URLì„ ë„¤ ì„œë²„ì—ì„œ ESP32 ìƒíƒœë¥¼ ì•Œë ¤ì£¼ëŠ” ì—”ë“œí¬ì¸íŠ¸ ì£¼ì†Œë¡œ ë°”ê¿”ì•¼ í•´!
        // ë„¤ Node.js ì„œë²„ ì˜ˆì‹œ ì½”ë“œì—ì„œ '/get-motion-status' ì£¼ì†Œì— í•´ë‹¹í•˜ëŠ” URLì´ì•¼.
        // ì˜ˆì‹œ: 'http://ë„¤_ì„œë²„_IP_ì£¼ì†Œ:í¬íŠ¸_ë²ˆí˜¸/get-motion-status'
        // ì˜ˆë¥¼ ë“¤ì–´ ë„¤ ì»´í“¨í„° IPê°€ 192.168.0.100ì´ê³  ì„œë²„ í¬íŠ¸ê°€ 3000ì´ë¼ë©´:
        // const serverStatusUrl = 'http://192.168.0.100:3000/get-motion-status';
        // ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†
        const serverStatusUrl = 'http://115.143.133.10:3000/motion_detected'; // <-- ì—¬ê¸°ë¥¼ ë„¤ ì„œë²„ ì£¼ì†Œë¡œ ë°”ê¿”ì¤˜!

        async function fetchMotionStatus() {
            const statusElement = document.getElementById('motionStatus');
            // ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸° ì‹œì‘í•  ë•Œ ë¡œë”© ìƒíƒœ í‘œì‹œ
            statusElement.textContent = 'ìƒíƒœ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...';
            statusElement.className = 'status-loading'; // ë¡œë”© ì¤‘ ìŠ¤íƒ€ì¼ ì ìš©

            try {
                // ì„¤ì •ëœ ì„œë²„ URLë¡œ ë¹„ë™ê¸° HTTP GET ìš”ì²­ ë³´ë‚´ê¸°
                // ì„œë²„ëŠ” 'detected' ë˜ëŠ” 'no_motion' ê°™ì€ ê°„ë‹¨í•œ ë¬¸ìì—´ì„ ì‘ë‹µìœ¼ë¡œ ì¤€ë‹¤ê³  ê°€ì •í•¨!
                const response = await fetch(serverStatusUrl);

                // HTTP ì‘ë‹µ ì½”ë“œê°€ 200 OK ê°™ì€ ì •ìƒ ë²”ìœ„ê°€ ì•„ë‹ˆë©´ ì—ëŸ¬ ë°œìƒì‹œí‚¤ê¸°
                if (!response.ok) {
                    throw new Error(`HTTP ì˜¤ë¥˜ ë°œìƒ! ìƒíƒœ ì½”ë“œ: ${response.status}`);
                }

                // ì„œë²„ ì‘ë‹µ ë³¸ë¬¸ì„ í…ìŠ¤íŠ¸ë¡œ ì½ì–´ì˜´
                const statusText = await response.text();
                console.log("ì„œë²„ ì‘ë‹µ ì›ë³¸:", statusText); // ê°œë°œì ë„êµ¬ ì½˜ì†”ì—ì„œ ì„œë²„ ì‘ë‹µ í™•ì¸ìš©

                // ì„œë²„ ì‘ë‹µ í…ìŠ¤íŠ¸ë¥¼ ì •ë¦¬í•˜ê³  ì†Œë¬¸ìë¡œ ë³€í™˜í•´ì„œ ë¹„êµ
                const cleanStatus = statusText.trim().toLowerCase();
                console.log("ì²˜ë¦¬ëœ ì„œë²„ ì‘ë‹µ:", cleanStatus); // ì²˜ë¦¬ëœ ì‘ë‹µ í™•ì¸ìš©

                // ì„œë²„ ì‘ë‹µì— ë”°ë¼ ì›¹í˜ì´ì§€ í™”ë©´ ì—…ë°ì´íŠ¸
                if (cleanStatus === 'detected') {
                    statusElement.textContent = 'ğŸš¨ ì›€ì§ì„ ê°ì§€ë¨! ğŸš¨';
                    statusElement.className = 'status-detected'; // ê°ì§€ ìŠ¤íƒ€ì¼ ì ìš© (ë¹¨ê°„ìƒ‰)
                } else if (cleanStatus === 'no_motion' || cleanStatus === 'no motion' || cleanStatus === '') {
                     // 'no_motion', 'no motion' ë˜ëŠ” ë¹ˆ ë¬¸ìì—´ ë“± ì›€ì§ì„ ì—†ìŒì„ ë‚˜íƒ€ë‚´ëŠ” ë‹¤ì–‘í•œ ì‘ë‹µ ì²˜ë¦¬
                    statusElement.textContent = 'âœ… ì›€ì§ì„ ì—†ìŒ';
                    statusElement.className = 'status-no-motion'; // ê°ì§€ ì•ˆ ë¨ ìŠ¤íƒ€ì¼ ì ìš© (ì´ˆë¡ìƒ‰)
                } else {
                    // ì˜ˆìƒì¹˜ ëª»í•œ ì‘ë‹µì´ ì™”ì„ ê²½ìš°
                    statusElement.textContent = `ì•Œ ìˆ˜ ì—†ëŠ” ìƒíƒœ: ${statusText}`;
                     statusElement.className = ''; // ê¸°ë³¸ ìŠ¤íƒ€ì¼ ìœ ì§€ ë˜ëŠ” ì—ëŸ¬ ìŠ¤íƒ€ì¼ ì¶”ê°€ ê°€ëŠ¥
                }

            } catch (error) {
                // ìš”ì²­ ì‹¤íŒ¨ ë˜ëŠ” ì—ëŸ¬ ë°œìƒ ì‹œ
                console.error("ìƒíƒœë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì—ëŸ¬ ë°œìƒ:", error);
                statusElement.textContent = 'âŒ ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨ ã… ã… ';
                statusElement.className = ''; // ê¸°ë³¸ ìŠ¤íƒ€ì¼ ë˜ëŠ” ì—ëŸ¬ ìŠ¤íƒ€ì¼ ì ìš©
            }
        }

        // ğŸš€ í˜ì´ì§€ê°€ ë¡œë“œë˜ìë§ˆì ë°”ë¡œ í•œë²ˆ ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸°
        fetchMotionStatus();

        // â±ï¸ ì„¤ì •ëœ ì‹œê°„ ê°„ê²©ë§ˆë‹¤ ì£¼ê¸°ì ìœ¼ë¡œ ìƒíƒœ ì—…ë°ì´íŠ¸ (ì˜ˆ: 3ì´ˆë§ˆë‹¤)
        // í•„ìš”ì— ë”°ë¼ ì‹œê°„(ë°€ë¦¬ì´ˆ) ì¡°ì ˆí•˜ì„¸ìš”! ë„ˆë¬´ ì§§ìœ¼ë©´ ì„œë²„ì— ë¶€í•˜ê°€ ê°ˆ ìˆ˜ ìˆì–´ìš”.
        const updateInterval = 3000; // 3000 ë°€ë¦¬ì´ˆ = 3ì´ˆ
        setInterval(fetchMotionStatus, updateInterval);

        console.log(`ì›¹í˜ì´ì§€ê°€ ${updateInterval / 1000}ì´ˆë§ˆë‹¤ ì„œë²„ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.`);

    </script>

</body>
</html>
